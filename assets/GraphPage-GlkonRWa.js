import{i as ut,c as oe,a as se,b as Ge,r as R,R as qe,j as _,P as ae,G as He,f as Ue,d as Ke}from"./index-k-PKClzA.js";var ce=180/Math.PI,Bt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function be(t,e,n,r,i,o){var s,a,u;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,u/=a),t*r<e*n&&(t=-t,e=-e,u=-u,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*ce,skewX:Math.atan(u)*ce,scaleX:s,scaleY:a}}var At;function Qe(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Bt:be(e.a,e.b,e.c,e.d,e.e,e.f)}function Ze(t){return t==null||(At||(At=document.createElementNS("http://www.w3.org/2000/svg","g")),At.setAttribute("transform",t),!(t=At.transform.baseVal.consolidate()))?Bt:(t=t.matrix,be(t.a,t.b,t.c,t.d,t.e,t.f))}function Ne(t,e,n,r){function i(c){return c.length?c.pop()+" ":""}function o(c,l,y,p,f,b){if(c!==y||l!==p){var v=f.push("translate(",null,e,null,n);b.push({i:v-4,x:ut(c,y)},{i:v-2,x:ut(l,p)})}else(y||p)&&f.push("translate("+y+e+p+n)}function s(c,l,y,p){c!==l?(c-l>180?l+=360:l-c>180&&(c+=360),p.push({i:y.push(i(y)+"rotate(",null,r)-2,x:ut(c,l)})):l&&y.push(i(y)+"rotate("+l+r)}function a(c,l,y,p){c!==l?p.push({i:y.push(i(y)+"skewX(",null,r)-2,x:ut(c,l)}):l&&y.push(i(y)+"skewX("+l+r)}function u(c,l,y,p,f,b){if(c!==y||l!==p){var v=f.push(i(f)+"scale(",null,",",null,")");b.push({i:v-4,x:ut(c,y)},{i:v-2,x:ut(l,p)})}else(y!==1||p!==1)&&f.push(i(f)+"scale("+y+","+p+")")}return function(c,l){var y=[],p=[];return c=t(c),l=t(l),o(c.translateX,c.translateY,l.translateX,l.translateY,y,p),s(c.rotate,l.rotate,y,p),a(c.skewX,l.skewX,y,p),u(c.scaleX,c.scaleY,l.scaleX,l.scaleY,y,p),c=l=null,function(f){for(var b=-1,v=p.length,m;++b<v;)y[(m=p[b]).i]=m.x(f);return y.join("")}}}var We=Ne(Qe,"px, ","px)","deg)"),Je=Ne(Ze,", ",")",")"),tn=1e-12;function ue(t){return((t=Math.exp(t))+1/t)/2}function en(t){return((t=Math.exp(t))-1/t)/2}function nn(t){return((t=Math.exp(2*t))-1)/(t+1)}const rn=(function t(e,n,r){function i(o,s){var a=o[0],u=o[1],c=o[2],l=s[0],y=s[1],p=s[2],f=l-a,b=y-u,v=f*f+b*b,m,g;if(v<tn)g=Math.log(p/c)/e,m=function(C){return[a+C*f,u+C*b,c*Math.exp(e*C*g)]};else{var N=Math.sqrt(v),j=(p*p-c*c+r*v)/(2*c*n*N),d=(p*p-c*c-r*v)/(2*p*n*N),k=Math.log(Math.sqrt(j*j+1)-j),I=Math.log(Math.sqrt(d*d+1)-d);g=(I-k)/e,m=function(C){var T=C*g,$=ue(k),D=c/(n*N)*($*nn(e*T+k)-en(k));return[a+D*f,u+D*b,c*$/ue(e*T+k)]}}return m.duration=g*1e3*e/Math.SQRT2,m}return i.rho=function(o){var s=Math.max(.001,+o),a=s*s,u=a*a;return t(s,a,u)},i})(Math.SQRT2,2,4);var on={value:()=>{}};function bt(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new jt(n)}function jt(t){this._=t}function sn(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}jt.prototype=bt.prototype={constructor:jt,on:function(t,e){var n=this._,r=sn(t+"",n),i,o=-1,s=r.length;if(arguments.length<2){for(;++o<s;)if((i=(t=r[o]).type)&&(i=an(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<s;)if(i=(t=r[o]).type)n[i]=le(n[i],t.name,e);else if(e==null)for(i in n)n[i]=le(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new jt(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],r=0,i=o.length;r<i;++r)o[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};function an(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function le(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=on,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Gt="http://www.w3.org/1999/xhtml";const fe={svg:"http://www.w3.org/2000/svg",xhtml:Gt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Rt(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),fe.hasOwnProperty(e)?{space:fe[e],local:t}:t}function cn(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Gt&&e.documentElement.namespaceURI===Gt?e.createElement(t):e.createElementNS(n,t)}}function un(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function ze(t){var e=Rt(t);return(e.local?un:cn)(e)}function ln(){}function Qt(t){return t==null?ln:function(){return this.querySelector(t)}}function fn(t){typeof t!="function"&&(t=Qt(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],s=o.length,a=r[i]=new Array(s),u,c,l=0;l<s;++l)(u=o[l])&&(c=t.call(u,u.__data__,l,o))&&("__data__"in u&&(c.__data__=u.__data__),a[l]=c);return new J(r,this._parents)}function hn(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function pn(){return[]}function ke(t){return t==null?pn:function(){return this.querySelectorAll(t)}}function dn(t){return function(){return hn(t.apply(this,arguments))}}function gn(t){typeof t=="function"?t=dn(t):t=ke(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var s=e[o],a=s.length,u,c=0;c<a;++c)(u=s[c])&&(r.push(t.call(u,u.__data__,c,s)),i.push(u));return new J(r,i)}function Se(t){return function(){return this.matches(t)}}function Ae(t){return function(e){return e.matches(t)}}var mn=Array.prototype.find;function yn(t){return function(){return mn.call(this.children,t)}}function vn(){return this.firstElementChild}function xn(t){return this.select(t==null?vn:yn(typeof t=="function"?t:Ae(t)))}var wn=Array.prototype.filter;function _n(){return Array.from(this.children)}function bn(t){return function(){return wn.call(this.children,t)}}function Nn(t){return this.selectAll(t==null?_n:bn(typeof t=="function"?t:Ae(t)))}function zn(t){typeof t!="function"&&(t=Se(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],s=o.length,a=r[i]=[],u,c=0;c<s;++c)(u=o[c])&&t.call(u,u.__data__,c,o)&&a.push(u);return new J(r,this._parents)}function Ee(t){return new Array(t.length)}function kn(){return new J(this._enter||this._groups.map(Ee),this._parents)}function Lt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Lt.prototype={constructor:Lt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Sn(t){return function(){return t}}function An(t,e,n,r,i,o){for(var s=0,a,u=e.length,c=o.length;s<c;++s)(a=e[s])?(a.__data__=o[s],r[s]=a):n[s]=new Lt(t,o[s]);for(;s<u;++s)(a=e[s])&&(i[s]=a)}function En(t,e,n,r,i,o,s){var a,u,c=new Map,l=e.length,y=o.length,p=new Array(l),f;for(a=0;a<l;++a)(u=e[a])&&(p[a]=f=s.call(u,u.__data__,a,e)+"",c.has(f)?i[a]=u:c.set(f,u));for(a=0;a<y;++a)f=s.call(t,o[a],a,o)+"",(u=c.get(f))?(r[a]=u,u.__data__=o[a],c.delete(f)):n[a]=new Lt(t,o[a]);for(a=0;a<l;++a)(u=e[a])&&c.get(p[a])===u&&(i[a]=u)}function Mn(t){return t.__data__}function jn(t,e){if(!arguments.length)return Array.from(this,Mn);var n=e?En:An,r=this._parents,i=this._groups;typeof t!="function"&&(t=Sn(t));for(var o=i.length,s=new Array(o),a=new Array(o),u=new Array(o),c=0;c<o;++c){var l=r[c],y=i[c],p=y.length,f=Cn(t.call(l,l&&l.__data__,c,r)),b=f.length,v=a[c]=new Array(b),m=s[c]=new Array(b),g=u[c]=new Array(p);n(l,y,v,m,g,f,e);for(var N=0,j=0,d,k;N<b;++N)if(d=v[N]){for(N>=j&&(j=N+1);!(k=m[j])&&++j<b;);d._next=k||null}}return s=new J(s,r),s._enter=a,s._exit=u,s}function Cn(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Tn(){return new J(this._exit||this._groups.map(Ee),this._parents)}function In(t,e,n){var r=this.enter(),i=this,o=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function Ln(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,s=Math.min(i,o),a=new Array(i),u=0;u<s;++u)for(var c=n[u],l=r[u],y=c.length,p=a[u]=new Array(y),f,b=0;b<y;++b)(f=c[b]||l[b])&&(p[b]=f);for(;u<i;++u)a[u]=n[u];return new J(a,this._parents)}function Dn(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,o=r[i],s;--i>=0;)(s=r[i])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function Fn(t){t||(t=$n);function e(y,p){return y&&p?t(y.__data__,p.__data__):!y-!p}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s=n[o],a=s.length,u=i[o]=new Array(a),c,l=0;l<a;++l)(c=s[l])&&(u[l]=c);u.sort(e)}return new J(i,this._parents).order()}function $n(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Rn(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Xn(){return Array.from(this)}function Pn(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null}function Yn(){let t=0;for(const e of this)++t;return t}function On(){return!this.node()}function Vn(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],o=0,s=i.length,a;o<s;++o)(a=i[o])&&t.call(a,a.__data__,o,i);return this}function Bn(t){return function(){this.removeAttribute(t)}}function Gn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function qn(t,e){return function(){this.setAttribute(t,e)}}function Hn(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Un(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Kn(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Qn(t,e){var n=Rt(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Gn:Bn:typeof e=="function"?n.local?Kn:Un:n.local?Hn:qn)(n,e))}function Me(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Zn(t){return function(){this.style.removeProperty(t)}}function Wn(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Jn(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function tr(t,e,n){return arguments.length>1?this.each((e==null?Zn:typeof e=="function"?Jn:Wn)(t,e,n??"")):pt(this.node(),t)}function pt(t,e){return t.style.getPropertyValue(e)||Me(t).getComputedStyle(t,null).getPropertyValue(e)}function er(t){return function(){delete this[t]}}function nr(t,e){return function(){this[t]=e}}function rr(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function ir(t,e){return arguments.length>1?this.each((e==null?er:typeof e=="function"?rr:nr)(t,e)):this.node()[t]}function je(t){return t.trim().split(/^|\s+/)}function Zt(t){return t.classList||new Ce(t)}function Ce(t){this._node=t,this._names=je(t.getAttribute("class")||"")}Ce.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Te(t,e){for(var n=Zt(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Ie(t,e){for(var n=Zt(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function or(t){return function(){Te(this,t)}}function sr(t){return function(){Ie(this,t)}}function ar(t,e){return function(){(e.apply(this,arguments)?Te:Ie)(this,t)}}function cr(t,e){var n=je(t+"");if(arguments.length<2){for(var r=Zt(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?ar:e?or:sr)(n,e))}function ur(){this.textContent=""}function lr(t){return function(){this.textContent=t}}function fr(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function hr(t){return arguments.length?this.each(t==null?ur:(typeof t=="function"?fr:lr)(t)):this.node().textContent}function pr(){this.innerHTML=""}function dr(t){return function(){this.innerHTML=t}}function gr(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function mr(t){return arguments.length?this.each(t==null?pr:(typeof t=="function"?gr:dr)(t)):this.node().innerHTML}function yr(){this.nextSibling&&this.parentNode.appendChild(this)}function vr(){return this.each(yr)}function xr(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function wr(){return this.each(xr)}function _r(t){var e=typeof t=="function"?t:ze(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function br(){return null}function Nr(t,e){var n=typeof t=="function"?t:ze(t),r=e==null?br:typeof e=="function"?e:Qt(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function zr(){var t=this.parentNode;t&&t.removeChild(this)}function kr(){return this.each(zr)}function Sr(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ar(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Er(t){return this.select(t?Ar:Sr)}function Mr(t){return arguments.length?this.property("__data__",t):this.node().__data__}function jr(t){return function(e){t.call(this,e,this.__data__)}}function Cr(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Tr(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,o;n<i;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++r]=o;++r?e.length=r:delete this.__on}}}function Ir(t,e,n){return function(){var r=this.__on,i,o=jr(e);if(r){for(var s=0,a=r.length;s<a;++s)if((i=r[s]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=e;return}}this.addEventListener(t.type,o,n),i={type:t.type,name:t.name,value:e,listener:o,options:n},r?r.push(i):this.__on=[i]}}function Lr(t,e,n){var r=Cr(t+""),i,o=r.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var u=0,c=a.length,l;u<c;++u)for(i=0,l=a[u];i<o;++i)if((s=r[i]).type===l.type&&s.name===l.name)return l.value}return}for(a=e?Ir:Tr,i=0;i<o;++i)this.each(a(r[i],e,n));return this}function Le(t,e,n){var r=Me(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Dr(t,e){return function(){return Le(this,t,e)}}function Fr(t,e){return function(){return Le(this,t,e.apply(this,arguments))}}function $r(t,e){return this.each((typeof e=="function"?Fr:Dr)(t,e))}function*Rr(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length,s;i<o;++i)(s=r[i])&&(yield s)}var De=[null];function J(t,e){this._groups=t,this._parents=e}function Nt(){return new J([[document.documentElement]],De)}function Xr(){return this}J.prototype=Nt.prototype={constructor:J,select:fn,selectAll:gn,selectChild:xn,selectChildren:Nn,filter:zn,data:jn,enter:kn,exit:Tn,join:In,merge:Ln,selection:Xr,order:Dn,sort:Fn,call:Rn,nodes:Xn,node:Pn,size:Yn,empty:On,each:Vn,attr:Qn,style:tr,property:ir,classed:cr,text:hr,html:mr,raise:vr,lower:wr,append:_r,insert:Nr,remove:kr,clone:Er,datum:Mr,on:Lr,dispatch:$r,[Symbol.iterator]:Rr};function W(t){return typeof t=="string"?new J([[document.querySelector(t)]],[document.documentElement]):new J([[t]],De)}function Pr(t){let e;for(;e=t.sourceEvent;)t=e;return t}function ot(t,e){if(t=Pr(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}const Yr={passive:!1},wt={capture:!0,passive:!1};function Ot(t){t.stopImmediatePropagation()}function ht(t){t.preventDefault(),t.stopImmediatePropagation()}function Fe(t){var e=t.document.documentElement,n=W(t).on("dragstart.drag",ht,wt);"onselectstart"in e?n.on("selectstart.drag",ht,wt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function $e(t,e){var n=t.document.documentElement,r=W(t).on("dragstart.drag",null);e&&(r.on("click.drag",ht,wt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Et=t=>()=>t;function qt(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:o,x:s,y:a,dx:u,dy:c,dispatch:l}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:u,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:l}})}qt.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function Or(t){return!t.ctrlKey&&!t.button}function Vr(){return this.parentNode}function Br(t,e){return e??{x:t.x,y:t.y}}function Gr(){return navigator.maxTouchPoints||"ontouchstart"in this}function qr(){var t=Or,e=Vr,n=Br,r=Gr,i={},o=bt("start","drag","end"),s=0,a,u,c,l,y=0;function p(d){d.on("mousedown.drag",f).filter(r).on("touchstart.drag",m).on("touchmove.drag",g,Yr).on("touchend.drag touchcancel.drag",N).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(d,k){if(!(l||!t.call(this,d,k))){var I=j(this,e.call(this,d,k),d,k,"mouse");I&&(W(d.view).on("mousemove.drag",b,wt).on("mouseup.drag",v,wt),Fe(d.view),Ot(d),c=!1,a=d.clientX,u=d.clientY,I("start",d))}}function b(d){if(ht(d),!c){var k=d.clientX-a,I=d.clientY-u;c=k*k+I*I>y}i.mouse("drag",d)}function v(d){W(d.view).on("mousemove.drag mouseup.drag",null),$e(d.view,c),ht(d),i.mouse("end",d)}function m(d,k){if(t.call(this,d,k)){var I=d.changedTouches,C=e.call(this,d,k),T=I.length,$,D;for($=0;$<T;++$)(D=j(this,C,d,k,I[$].identifier,I[$]))&&(Ot(d),D("start",d,I[$]))}}function g(d){var k=d.changedTouches,I=k.length,C,T;for(C=0;C<I;++C)(T=i[k[C].identifier])&&(ht(d),T("drag",d,k[C]))}function N(d){var k=d.changedTouches,I=k.length,C,T;for(l&&clearTimeout(l),l=setTimeout(function(){l=null},500),C=0;C<I;++C)(T=i[k[C].identifier])&&(Ot(d),T("end",d,k[C]))}function j(d,k,I,C,T,$){var D=o.copy(),F=ot($||I,k),E,V,h;if((h=n.call(d,new qt("beforestart",{sourceEvent:I,target:p,identifier:T,active:s,x:F[0],y:F[1],dx:0,dy:0,dispatch:D}),C))!=null)return E=h.x-F[0]||0,V=h.y-F[1]||0,function z(x,A,L){var w=F,M;switch(x){case"start":i[T]=z,M=s++;break;case"end":delete i[T],--s;case"drag":F=ot(L||A,k),M=s;break}D.call(x,d,new qt(x,{sourceEvent:A,subject:h,target:p,identifier:T,active:M,x:F[0]+E,y:F[1]+V,dx:F[0]-w[0],dy:F[1]-w[1],dispatch:D}),C)}}return p.filter=function(d){return arguments.length?(t=typeof d=="function"?d:Et(!!d),p):t},p.container=function(d){return arguments.length?(e=typeof d=="function"?d:Et(d),p):e},p.subject=function(d){return arguments.length?(n=typeof d=="function"?d:Et(d),p):n},p.touchable=function(d){return arguments.length?(r=typeof d=="function"?d:Et(!!d),p):r},p.on=function(){var d=o.on.apply(o,arguments);return d===o?p:d},p.clickDistance=function(d){return arguments.length?(y=(d=+d)*d,p):Math.sqrt(y)},p}var dt=0,vt=0,mt=0,Re=1e3,Dt,xt,Ft=0,lt=0,Xt=0,_t=typeof performance=="object"&&performance.now?performance:Date,Xe=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Wt(){return lt||(Xe(Hr),lt=_t.now()+Xt)}function Hr(){lt=0}function $t(){this._call=this._time=this._next=null}$t.prototype=Jt.prototype={constructor:$t,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Wt():+n)+(e==null?0:+e),!this._next&&xt!==this&&(xt?xt._next=this:Dt=this,xt=this),this._call=t,this._time=n,Ht()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ht())}};function Jt(t,e,n){var r=new $t;return r.restart(t,e,n),r}function Ur(){Wt(),++dt;for(var t=Dt,e;t;)(e=lt-t._time)>=0&&t._call.call(void 0,e),t=t._next;--dt}function he(){lt=(Ft=_t.now())+Xt,dt=vt=0;try{Ur()}finally{dt=0,Qr(),lt=0}}function Kr(){var t=_t.now(),e=t-Ft;e>Re&&(Xt-=e,Ft=t)}function Qr(){for(var t,e=Dt,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Dt=n);xt=t,Ht(r)}function Ht(t){if(!dt){vt&&(vt=clearTimeout(vt));var e=t-lt;e>24?(t<1/0&&(vt=setTimeout(he,t-_t.now()-Xt)),mt&&(mt=clearInterval(mt))):(mt||(Ft=_t.now(),mt=setInterval(Kr,Re)),dt=1,Xe(he))}}function pe(t,e,n){var r=new $t;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var Zr=bt("start","end","cancel","interrupt"),Wr=[],Pe=0,de=1,Ut=2,Ct=3,ge=4,Kt=5,Tt=6;function Pt(t,e,n,r,i,o){var s=t.__transition;if(!s)t.__transition={};else if(n in s)return;Jr(t,n,{name:e,index:r,group:i,on:Zr,tween:Wr,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Pe})}function te(t,e){var n=nt(t,e);if(n.state>Pe)throw new Error("too late; already scheduled");return n}function rt(t,e){var n=nt(t,e);if(n.state>Ct)throw new Error("too late; already running");return n}function nt(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Jr(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=Jt(o,0,n.time);function o(c){n.state=de,n.timer.restart(s,n.delay,n.time),n.delay<=c&&s(c-n.delay)}function s(c){var l,y,p,f;if(n.state!==de)return u();for(l in r)if(f=r[l],f.name===n.name){if(f.state===Ct)return pe(s);f.state===ge?(f.state=Tt,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete r[l]):+l<e&&(f.state=Tt,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete r[l])}if(pe(function(){n.state===Ct&&(n.state=ge,n.timer.restart(a,n.delay,n.time),a(c))}),n.state=Ut,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Ut){for(n.state=Ct,i=new Array(p=n.tween.length),l=0,y=-1;l<p;++l)(f=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(i[++y]=f);i.length=y+1}}function a(c){for(var l=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(u),n.state=Kt,1),y=-1,p=i.length;++y<p;)i[y].call(t,l);n.state===Kt&&(n.on.call("end",t,t.__data__,n.index,n.group),u())}function u(){n.state=Tt,n.timer.stop(),delete r[e];for(var c in r)return;delete t.__transition}}function It(t,e){var n=t.__transition,r,i,o=!0,s;if(n){e=e==null?null:e+"";for(s in n){if((r=n[s]).name!==e){o=!1;continue}i=r.state>Ut&&r.state<Kt,r.state=Tt,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[s]}o&&delete t.__transition}}function ti(t){return this.each(function(){It(this,t)})}function ei(t,e){var n,r;return function(){var i=rt(this,t),o=i.tween;if(o!==n){r=n=o;for(var s=0,a=r.length;s<a;++s)if(r[s].name===e){r=r.slice(),r.splice(s,1);break}}i.tween=r}}function ni(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=rt(this,t),s=o.tween;if(s!==r){i=(r=s).slice();for(var a={name:e,value:n},u=0,c=i.length;u<c;++u)if(i[u].name===e){i[u]=a;break}u===c&&i.push(a)}o.tween=i}}function ri(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=nt(this.node(),n).tween,i=0,o=r.length,s;i<o;++i)if((s=r[i]).name===t)return s.value;return null}return this.each((e==null?ei:ni)(n,t,e))}function ee(t,e,n){var r=t._id;return t.each(function(){var i=rt(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return nt(i,r).value[e]}}function Ye(t,e){var n;return(typeof e=="number"?ut:e instanceof oe?se:(n=oe(e))?(e=n,se):Ge)(t,e)}function ii(t){return function(){this.removeAttribute(t)}}function oi(t){return function(){this.removeAttributeNS(t.space,t.local)}}function si(t,e,n){var r,i=n+"",o;return function(){var s=this.getAttribute(t);return s===i?null:s===r?o:o=e(r=s,n)}}function ai(t,e,n){var r,i=n+"",o;return function(){var s=this.getAttributeNS(t.space,t.local);return s===i?null:s===r?o:o=e(r=s,n)}}function ci(t,e,n){var r,i,o;return function(){var s,a=n(this),u;return a==null?void this.removeAttribute(t):(s=this.getAttribute(t),u=a+"",s===u?null:s===r&&u===i?o:(i=u,o=e(r=s,a)))}}function ui(t,e,n){var r,i,o;return function(){var s,a=n(this),u;return a==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),u=a+"",s===u?null:s===r&&u===i?o:(i=u,o=e(r=s,a)))}}function li(t,e){var n=Rt(t),r=n==="transform"?Je:Ye;return this.attrTween(t,typeof e=="function"?(n.local?ui:ci)(n,r,ee(this,"attr."+t,e)):e==null?(n.local?oi:ii)(n):(n.local?ai:si)(n,r,e))}function fi(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function hi(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function pi(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&hi(t,o)),n}return i._value=e,i}function di(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&fi(t,o)),n}return i._value=e,i}function gi(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=Rt(t);return this.tween(n,(r.local?pi:di)(r,e))}function mi(t,e){return function(){te(this,t).delay=+e.apply(this,arguments)}}function yi(t,e){return e=+e,function(){te(this,t).delay=e}}function vi(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?mi:yi)(e,t)):nt(this.node(),e).delay}function xi(t,e){return function(){rt(this,t).duration=+e.apply(this,arguments)}}function wi(t,e){return e=+e,function(){rt(this,t).duration=e}}function _i(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?xi:wi)(e,t)):nt(this.node(),e).duration}function bi(t,e){if(typeof e!="function")throw new Error;return function(){rt(this,t).ease=e}}function Ni(t){var e=this._id;return arguments.length?this.each(bi(e,t)):nt(this.node(),e).ease}function zi(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;rt(this,t).ease=n}}function ki(t){if(typeof t!="function")throw new Error;return this.each(zi(this._id,t))}function Si(t){typeof t!="function"&&(t=Se(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],s=o.length,a=r[i]=[],u,c=0;c<s;++c)(u=o[c])&&t.call(u,u.__data__,c,o)&&a.push(u);return new at(r,this._parents,this._name,this._id)}function Ai(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),s=new Array(r),a=0;a<o;++a)for(var u=e[a],c=n[a],l=u.length,y=s[a]=new Array(l),p,f=0;f<l;++f)(p=u[f]||c[f])&&(y[f]=p);for(;a<r;++a)s[a]=e[a];return new at(s,this._parents,this._name,this._id)}function Ei(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Mi(t,e,n){var r,i,o=Ei(e)?te:rt;return function(){var s=o(this,t),a=s.on;a!==r&&(i=(r=a).copy()).on(e,n),s.on=i}}function ji(t,e){var n=this._id;return arguments.length<2?nt(this.node(),n).on.on(t):this.each(Mi(n,t,e))}function Ci(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Ti(){return this.on("end.remove",Ci(this._id))}function Ii(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Qt(t));for(var r=this._groups,i=r.length,o=new Array(i),s=0;s<i;++s)for(var a=r[s],u=a.length,c=o[s]=new Array(u),l,y,p=0;p<u;++p)(l=a[p])&&(y=t.call(l,l.__data__,p,a))&&("__data__"in l&&(y.__data__=l.__data__),c[p]=y,Pt(c[p],e,n,p,c,nt(l,n)));return new at(o,this._parents,e,n)}function Li(t){var e=this._name,n=this._id;typeof t!="function"&&(t=ke(t));for(var r=this._groups,i=r.length,o=[],s=[],a=0;a<i;++a)for(var u=r[a],c=u.length,l,y=0;y<c;++y)if(l=u[y]){for(var p=t.call(l,l.__data__,y,u),f,b=nt(l,n),v=0,m=p.length;v<m;++v)(f=p[v])&&Pt(f,e,n,v,p,b);o.push(p),s.push(l)}return new at(o,s,e,n)}var Di=Nt.prototype.constructor;function Fi(){return new Di(this._groups,this._parents)}function $i(t,e){var n,r,i;return function(){var o=pt(this,t),s=(this.style.removeProperty(t),pt(this,t));return o===s?null:o===n&&s===r?i:i=e(n=o,r=s)}}function Oe(t){return function(){this.style.removeProperty(t)}}function Ri(t,e,n){var r,i=n+"",o;return function(){var s=pt(this,t);return s===i?null:s===r?o:o=e(r=s,n)}}function Xi(t,e,n){var r,i,o;return function(){var s=pt(this,t),a=n(this),u=a+"";return a==null&&(u=a=(this.style.removeProperty(t),pt(this,t))),s===u?null:s===r&&u===i?o:(i=u,o=e(r=s,a))}}function Pi(t,e){var n,r,i,o="style."+e,s="end."+o,a;return function(){var u=rt(this,t),c=u.on,l=u.value[o]==null?a||(a=Oe(e)):void 0;(c!==n||i!==l)&&(r=(n=c).copy()).on(s,i=l),u.on=r}}function Yi(t,e,n){var r=(t+="")=="transform"?We:Ye;return e==null?this.styleTween(t,$i(t,r)).on("end.style."+t,Oe(t)):typeof e=="function"?this.styleTween(t,Xi(t,r,ee(this,"style."+t,e))).each(Pi(this._id,t)):this.styleTween(t,Ri(t,r,e),n).on("end.style."+t,null)}function Oi(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Vi(t,e,n){var r,i;function o(){var s=e.apply(this,arguments);return s!==i&&(r=(i=s)&&Oi(t,s,n)),r}return o._value=e,o}function Bi(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,Vi(t,e,n??""))}function Gi(t){return function(){this.textContent=t}}function qi(t){return function(){var e=t(this);this.textContent=e??""}}function Hi(t){return this.tween("text",typeof t=="function"?qi(ee(this,"text",t)):Gi(t==null?"":t+""))}function Ui(t){return function(e){this.textContent=t.call(this,e)}}function Ki(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&Ui(i)),e}return r._value=t,r}function Qi(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Ki(t))}function Zi(){for(var t=this._name,e=this._id,n=Ve(),r=this._groups,i=r.length,o=0;o<i;++o)for(var s=r[o],a=s.length,u,c=0;c<a;++c)if(u=s[c]){var l=nt(u,e);Pt(u,t,n,c,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new at(r,this._parents,t,n)}function Wi(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(o,s){var a={value:s},u={value:function(){--i===0&&o()}};n.each(function(){var c=rt(this,r),l=c.on;l!==t&&(e=(t=l).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(u)),c.on=e}),i===0&&o()})}var Ji=0;function at(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Ve(){return++Ji}var it=Nt.prototype;at.prototype={constructor:at,select:Ii,selectAll:Li,selectChild:it.selectChild,selectChildren:it.selectChildren,filter:Si,merge:Ai,selection:Fi,transition:Zi,call:it.call,nodes:it.nodes,node:it.node,size:it.size,empty:it.empty,each:it.each,on:ji,attr:li,attrTween:gi,style:Yi,styleTween:Bi,text:Hi,textTween:Qi,remove:Ti,tween:ri,delay:vi,duration:_i,ease:Ni,easeVarying:ki,end:Wi,[Symbol.iterator]:it[Symbol.iterator]};function to(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var eo={time:null,delay:0,duration:250,ease:to};function no(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function ro(t){var e,n;t instanceof at?(e=t._id,t=t._name):(e=Ve(),(n=eo).time=Wt(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var s=r[o],a=s.length,u,c=0;c<a;++c)(u=s[c])&&Pt(u,t,e,c,s,n||no(u,e));return new at(r,this._parents,t,e)}Nt.prototype.interrupt=ti;Nt.prototype.transition=ro;function io(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return Be(this.cover(e,n),e,n,t)}function Be(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o=t._root,s={data:r},a=t._x0,u=t._y0,c=t._x1,l=t._y1,y,p,f,b,v,m,g,N;if(!o)return t._root=s,t;for(;o.length;)if((v=e>=(y=(a+c)/2))?a=y:c=y,(m=n>=(p=(u+l)/2))?u=p:l=p,i=o,!(o=o[g=m<<1|v]))return i[g]=s,t;if(f=+t._x.call(null,o.data),b=+t._y.call(null,o.data),e===f&&n===b)return s.next=o,i?i[g]=s:t._root=s,t;do i=i?i[g]=new Array(4):t._root=new Array(4),(v=e>=(y=(a+c)/2))?a=y:c=y,(m=n>=(p=(u+l)/2))?u=p:l=p;while((g=m<<1|v)===(N=(b>=p)<<1|f>=y));return i[N]=o,i[g]=s,t}function oo(t){var e,n,r=t.length,i,o,s=new Array(r),a=new Array(r),u=1/0,c=1/0,l=-1/0,y=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(o=+this._y.call(null,e))||(s[n]=i,a[n]=o,i<u&&(u=i),i>l&&(l=i),o<c&&(c=o),o>y&&(y=o));if(u>l||c>y)return this;for(this.cover(u,c).cover(l,y),n=0;n<r;++n)Be(this,s[n],a[n],t[n]);return this}function so(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{for(var s=i-n||1,a=this._root,u,c;n>t||t>=i||r>e||e>=o;)switch(c=(e<r)<<1|t<n,u=new Array(4),u[c]=a,a=u,s*=2,c){case 0:i=n+s,o=r+s;break;case 1:n=i-s,o=r+s;break;case 2:i=n+s,r=o-s;break;case 3:n=i-s,r=o-s;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this}function ao(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function co(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function K(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function uo(t,e,n){var r,i=this._x0,o=this._y0,s,a,u,c,l=this._x1,y=this._y1,p=[],f=this._root,b,v;for(f&&p.push(new K(f,i,o,l,y)),n==null?n=1/0:(i=t-n,o=e-n,l=t+n,y=e+n,n*=n);b=p.pop();)if(!(!(f=b.node)||(s=b.x0)>l||(a=b.y0)>y||(u=b.x1)<i||(c=b.y1)<o))if(f.length){var m=(s+u)/2,g=(a+c)/2;p.push(new K(f[3],m,g,u,c),new K(f[2],s,g,m,c),new K(f[1],m,a,u,g),new K(f[0],s,a,m,g)),(v=(e>=g)<<1|t>=m)&&(b=p[p.length-1],p[p.length-1]=p[p.length-1-v],p[p.length-1-v]=b)}else{var N=t-+this._x.call(null,f.data),j=e-+this._y.call(null,f.data),d=N*N+j*j;if(d<n){var k=Math.sqrt(n=d);i=t-k,o=e-k,l=t+k,y=e+k,r=f.data}}return r}function lo(t){if(isNaN(l=+this._x.call(null,t))||isNaN(y=+this._y.call(null,t)))return this;var e,n=this._root,r,i,o,s=this._x0,a=this._y0,u=this._x1,c=this._y1,l,y,p,f,b,v,m,g;if(!n)return this;if(n.length)for(;;){if((b=l>=(p=(s+u)/2))?s=p:u=p,(v=y>=(f=(a+c)/2))?a=f:c=f,e=n,!(n=n[m=v<<1|b]))return this;if(!n.length)break;(e[m+1&3]||e[m+2&3]||e[m+3&3])&&(r=e,g=m)}for(;n.data!==t;)if(i=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,i?(o?i.next=o:delete i.next,this):e?(o?e[m]=o:delete e[m],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(r?r[g]=n:this._root=n),this):(this._root=o,this)}function fo(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function ho(){return this._root}function po(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function go(t){var e=[],n,r=this._root,i,o,s,a,u;for(r&&e.push(new K(r,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(r=n.node,o=n.x0,s=n.y0,a=n.x1,u=n.y1)&&r.length){var c=(o+a)/2,l=(s+u)/2;(i=r[3])&&e.push(new K(i,c,l,a,u)),(i=r[2])&&e.push(new K(i,o,l,c,u)),(i=r[1])&&e.push(new K(i,c,s,a,l)),(i=r[0])&&e.push(new K(i,o,s,c,l))}return this}function mo(t){var e=[],n=[],r;for(this._root&&e.push(new K(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var i=r.node;if(i.length){var o,s=r.x0,a=r.y0,u=r.x1,c=r.y1,l=(s+u)/2,y=(a+c)/2;(o=i[0])&&e.push(new K(o,s,a,l,y)),(o=i[1])&&e.push(new K(o,l,a,u,y)),(o=i[2])&&e.push(new K(o,s,y,l,c)),(o=i[3])&&e.push(new K(o,l,y,u,c))}n.push(r)}for(;r=n.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function yo(t){return t[0]}function vo(t){return arguments.length?(this._x=t,this):this._x}function xo(t){return t[1]}function wo(t){return arguments.length?(this._y=t,this):this._y}function ne(t,e,n){var r=new re(e??yo,n??xo,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function re(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function me(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var Z=ne.prototype=re.prototype;Z.copy=function(){var t=new re(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,r;if(!e)return t;if(!e.length)return t._root=me(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var i=0;i<4;++i)(r=e.source[i])&&(r.length?n.push({source:r,target:e.target[i]=new Array(4)}):e.target[i]=me(r));return t};Z.add=io;Z.addAll=oo;Z.cover=so;Z.data=ao;Z.extent=co;Z.find=uo;Z.remove=lo;Z.removeAll=fo;Z.root=ho;Z.size=po;Z.visit=go;Z.visitAfter=mo;Z.x=vo;Z.y=wo;function Q(t){return function(){return t}}function ct(t){return(t()-.5)*1e-6}function _o(t){return t.x+t.vx}function bo(t){return t.y+t.vy}function No(t){var e,n,r,i=1,o=1;typeof t!="function"&&(t=Q(t==null?1:+t));function s(){for(var c,l=e.length,y,p,f,b,v,m,g=0;g<o;++g)for(y=ne(e,_o,bo).visitAfter(a),c=0;c<l;++c)p=e[c],v=n[p.index],m=v*v,f=p.x+p.vx,b=p.y+p.vy,y.visit(N);function N(j,d,k,I,C){var T=j.data,$=j.r,D=v+$;if(T){if(T.index>p.index){var F=f-T.x-T.vx,E=b-T.y-T.vy,V=F*F+E*E;V<D*D&&(F===0&&(F=ct(r),V+=F*F),E===0&&(E=ct(r),V+=E*E),V=(D-(V=Math.sqrt(V)))/V*i,p.vx+=(F*=V)*(D=($*=$)/(m+$)),p.vy+=(E*=V)*D,T.vx-=F*(D=1-D),T.vy-=E*D)}return}return d>f+D||I<f-D||k>b+D||C<b-D}}function a(c){if(c.data)return c.r=n[c.data.index];for(var l=c.r=0;l<4;++l)c[l]&&c[l].r>c.r&&(c.r=c[l].r)}function u(){if(e){var c,l=e.length,y;for(n=new Array(l),c=0;c<l;++c)y=e[c],n[y.index]=+t(y,c,e)}}return s.initialize=function(c,l){e=c,r=l,u()},s.iterations=function(c){return arguments.length?(o=+c,s):o},s.strength=function(c){return arguments.length?(i=+c,s):i},s.radius=function(c){return arguments.length?(t=typeof c=="function"?c:Q(+c),u(),s):t},s}function zo(t){return t.index}function ye(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function ko(t){var e=zo,n=y,r,i=Q(30),o,s,a,u,c,l=1;t==null&&(t=[]);function y(m){return 1/Math.min(a[m.source.index],a[m.target.index])}function p(m){for(var g=0,N=t.length;g<l;++g)for(var j=0,d,k,I,C,T,$,D;j<N;++j)d=t[j],k=d.source,I=d.target,C=I.x+I.vx-k.x-k.vx||ct(c),T=I.y+I.vy-k.y-k.vy||ct(c),$=Math.sqrt(C*C+T*T),$=($-o[j])/$*m*r[j],C*=$,T*=$,I.vx-=C*(D=u[j]),I.vy-=T*D,k.vx+=C*(D=1-D),k.vy+=T*D}function f(){if(s){var m,g=s.length,N=t.length,j=new Map(s.map((k,I)=>[e(k,I,s),k])),d;for(m=0,a=new Array(g);m<N;++m)d=t[m],d.index=m,typeof d.source!="object"&&(d.source=ye(j,d.source)),typeof d.target!="object"&&(d.target=ye(j,d.target)),a[d.source.index]=(a[d.source.index]||0)+1,a[d.target.index]=(a[d.target.index]||0)+1;for(m=0,u=new Array(N);m<N;++m)d=t[m],u[m]=a[d.source.index]/(a[d.source.index]+a[d.target.index]);r=new Array(N),b(),o=new Array(N),v()}}function b(){if(s)for(var m=0,g=t.length;m<g;++m)r[m]=+n(t[m],m,t)}function v(){if(s)for(var m=0,g=t.length;m<g;++m)o[m]=+i(t[m],m,t)}return p.initialize=function(m,g){s=m,c=g,f()},p.links=function(m){return arguments.length?(t=m,f(),p):t},p.id=function(m){return arguments.length?(e=m,p):e},p.iterations=function(m){return arguments.length?(l=+m,p):l},p.strength=function(m){return arguments.length?(n=typeof m=="function"?m:Q(+m),b(),p):n},p.distance=function(m){return arguments.length?(i=typeof m=="function"?m:Q(+m),v(),p):i},p}const So=1664525,Ao=1013904223,ve=4294967296;function Eo(){let t=1;return()=>(t=(So*t+Ao)%ve)/ve}function Mo(t){return t.x}function jo(t){return t.y}var Co=10,To=Math.PI*(3-Math.sqrt(5));function Io(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,s=.6,a=new Map,u=Jt(y),c=bt("tick","end"),l=Eo();t==null&&(t=[]);function y(){p(),c.call("tick",e),n<r&&(u.stop(),c.call("end",e))}function p(v){var m,g=t.length,N;v===void 0&&(v=1);for(var j=0;j<v;++j)for(n+=(o-n)*i,a.forEach(function(d){d(n)}),m=0;m<g;++m)N=t[m],N.fx==null?N.x+=N.vx*=s:(N.x=N.fx,N.vx=0),N.fy==null?N.y+=N.vy*=s:(N.y=N.fy,N.vy=0);return e}function f(){for(var v=0,m=t.length,g;v<m;++v){if(g=t[v],g.index=v,g.fx!=null&&(g.x=g.fx),g.fy!=null&&(g.y=g.fy),isNaN(g.x)||isNaN(g.y)){var N=Co*Math.sqrt(.5+v),j=v*To;g.x=N*Math.cos(j),g.y=N*Math.sin(j)}(isNaN(g.vx)||isNaN(g.vy))&&(g.vx=g.vy=0)}}function b(v){return v.initialize&&v.initialize(t,l),v}return f(),e={tick:p,restart:function(){return u.restart(y),e},stop:function(){return u.stop(),e},nodes:function(v){return arguments.length?(t=v,f(),a.forEach(b),e):t},alpha:function(v){return arguments.length?(n=+v,e):n},alphaMin:function(v){return arguments.length?(r=+v,e):r},alphaDecay:function(v){return arguments.length?(i=+v,e):+i},alphaTarget:function(v){return arguments.length?(o=+v,e):o},velocityDecay:function(v){return arguments.length?(s=1-v,e):1-s},randomSource:function(v){return arguments.length?(l=v,a.forEach(b),e):l},force:function(v,m){return arguments.length>1?(m==null?a.delete(v):a.set(v,b(m)),e):a.get(v)},find:function(v,m,g){var N=0,j=t.length,d,k,I,C,T;for(g==null?g=1/0:g*=g,N=0;N<j;++N)C=t[N],d=v-C.x,k=m-C.y,I=d*d+k*k,I<g&&(T=C,g=I);return T},on:function(v,m){return arguments.length>1?(c.on(v,m),e):c.on(v)}}}function Lo(){var t,e,n,r,i=Q(-30),o,s=1,a=1/0,u=.81;function c(f){var b,v=t.length,m=ne(t,Mo,jo).visitAfter(y);for(r=f,b=0;b<v;++b)e=t[b],m.visit(p)}function l(){if(t){var f,b=t.length,v;for(o=new Array(b),f=0;f<b;++f)v=t[f],o[v.index]=+i(v,f,t)}}function y(f){var b=0,v,m,g=0,N,j,d;if(f.length){for(N=j=d=0;d<4;++d)(v=f[d])&&(m=Math.abs(v.value))&&(b+=v.value,g+=m,N+=m*v.x,j+=m*v.y);f.x=N/g,f.y=j/g}else{v=f,v.x=v.data.x,v.y=v.data.y;do b+=o[v.data.index];while(v=v.next)}f.value=b}function p(f,b,v,m){if(!f.value)return!0;var g=f.x-e.x,N=f.y-e.y,j=m-b,d=g*g+N*N;if(j*j/u<d)return d<a&&(g===0&&(g=ct(n),d+=g*g),N===0&&(N=ct(n),d+=N*N),d<s&&(d=Math.sqrt(s*d)),e.vx+=g*f.value*r/d,e.vy+=N*f.value*r/d),!0;if(f.length||d>=a)return;(f.data!==e||f.next)&&(g===0&&(g=ct(n),d+=g*g),N===0&&(N=ct(n),d+=N*N),d<s&&(d=Math.sqrt(s*d)));do f.data!==e&&(j=o[f.data.index]*r/d,e.vx+=g*j,e.vy+=N*j);while(f=f.next)}return c.initialize=function(f,b){t=f,n=b,l()},c.strength=function(f){return arguments.length?(i=typeof f=="function"?f:Q(+f),l(),c):i},c.distanceMin=function(f){return arguments.length?(s=f*f,c):Math.sqrt(s)},c.distanceMax=function(f){return arguments.length?(a=f*f,c):Math.sqrt(a)},c.theta=function(f){return arguments.length?(u=f*f,c):Math.sqrt(u)},c}function Do(t){var e=Q(.1),n,r,i;typeof t!="function"&&(t=Q(t==null?0:+t));function o(a){for(var u=0,c=n.length,l;u<c;++u)l=n[u],l.vx+=(i[u]-l.x)*r[u]*a}function s(){if(n){var a,u=n.length;for(r=new Array(u),i=new Array(u),a=0;a<u;++a)r[a]=isNaN(i[a]=+t(n[a],a,n))?0:+e(n[a],a,n)}}return o.initialize=function(a){n=a,s()},o.strength=function(a){return arguments.length?(e=typeof a=="function"?a:Q(+a),s(),o):e},o.x=function(a){return arguments.length?(t=typeof a=="function"?a:Q(+a),s(),o):t},o}function Fo(t){var e=Q(.1),n,r,i;typeof t!="function"&&(t=Q(t==null?0:+t));function o(a){for(var u=0,c=n.length,l;u<c;++u)l=n[u],l.vy+=(i[u]-l.y)*r[u]*a}function s(){if(n){var a,u=n.length;for(r=new Array(u),i=new Array(u),a=0;a<u;++a)r[a]=isNaN(i[a]=+t(n[a],a,n))?0:+e(n[a],a,n)}}return o.initialize=function(a){n=a,s()},o.strength=function(a){return arguments.length?(e=typeof a=="function"?a:Q(+a),s(),o):e},o.y=function(a){return arguments.length?(t=typeof a=="function"?a:Q(+a),s(),o):t},o}const Mt=t=>()=>t;function $o(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function st(t,e,n){this.k=t,this.x=e,this.y=n}st.prototype={constructor:st,scale:function(t){return t===1?this:new st(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new st(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Yt=new st(1,0,0);st.prototype;function Vt(t){t.stopImmediatePropagation()}function yt(t){t.preventDefault(),t.stopImmediatePropagation()}function Ro(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function Xo(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function xe(){return this.__zoom||Yt}function Po(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Yo(){return navigator.maxTouchPoints||"ontouchstart"in this}function Oo(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],s=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}function Vo(){var t=Ro,e=Xo,n=Oo,r=Po,i=Yo,o=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,u=rn,c=bt("start","zoom","end"),l,y,p,f=500,b=150,v=0,m=10;function g(h){h.property("__zoom",xe).on("wheel.zoom",T,{passive:!1}).on("mousedown.zoom",$).on("dblclick.zoom",D).filter(i).on("touchstart.zoom",F).on("touchmove.zoom",E).on("touchend.zoom touchcancel.zoom",V).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(h,z,x,A){var L=h.selection?h.selection():h;L.property("__zoom",xe),h!==L?k(h,z,x,A):L.interrupt().each(function(){I(this,arguments).event(A).start().zoom(null,typeof z=="function"?z.apply(this,arguments):z).end()})},g.scaleBy=function(h,z,x,A){g.scaleTo(h,function(){var L=this.__zoom.k,w=typeof z=="function"?z.apply(this,arguments):z;return L*w},x,A)},g.scaleTo=function(h,z,x,A){g.transform(h,function(){var L=e.apply(this,arguments),w=this.__zoom,M=x==null?d(L):typeof x=="function"?x.apply(this,arguments):x,S=w.invert(M),Y=typeof z=="function"?z.apply(this,arguments):z;return n(j(N(w,Y),M,S),L,s)},x,A)},g.translateBy=function(h,z,x,A){g.transform(h,function(){return n(this.__zoom.translate(typeof z=="function"?z.apply(this,arguments):z,typeof x=="function"?x.apply(this,arguments):x),e.apply(this,arguments),s)},null,A)},g.translateTo=function(h,z,x,A,L){g.transform(h,function(){var w=e.apply(this,arguments),M=this.__zoom,S=A==null?d(w):typeof A=="function"?A.apply(this,arguments):A;return n(Yt.translate(S[0],S[1]).scale(M.k).translate(typeof z=="function"?-z.apply(this,arguments):-z,typeof x=="function"?-x.apply(this,arguments):-x),w,s)},A,L)};function N(h,z){return z=Math.max(o[0],Math.min(o[1],z)),z===h.k?h:new st(z,h.x,h.y)}function j(h,z,x){var A=z[0]-x[0]*h.k,L=z[1]-x[1]*h.k;return A===h.x&&L===h.y?h:new st(h.k,A,L)}function d(h){return[(+h[0][0]+ +h[1][0])/2,(+h[0][1]+ +h[1][1])/2]}function k(h,z,x,A){h.on("start.zoom",function(){I(this,arguments).event(A).start()}).on("interrupt.zoom end.zoom",function(){I(this,arguments).event(A).end()}).tween("zoom",function(){var L=this,w=arguments,M=I(L,w).event(A),S=e.apply(L,w),Y=x==null?d(S):typeof x=="function"?x.apply(L,w):x,X=Math.max(S[1][0]-S[0][0],S[1][1]-S[0][1]),P=L.__zoom,G=typeof z=="function"?z.apply(L,w):z,q=u(P.invert(Y).concat(X/P.k),G.invert(Y).concat(X/G.k));return function(H){if(H===1)H=G;else{var B=q(H),tt=X/B[2];H=new st(tt,Y[0]-B[0]*tt,Y[1]-B[1]*tt)}M.zoom(null,H)}})}function I(h,z,x){return!x&&h.__zooming||new C(h,z)}function C(h,z){this.that=h,this.args=z,this.active=0,this.sourceEvent=null,this.extent=e.apply(h,z),this.taps=0}C.prototype={event:function(h){return h&&(this.sourceEvent=h),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(h,z){return this.mouse&&h!=="mouse"&&(this.mouse[1]=z.invert(this.mouse[0])),this.touch0&&h!=="touch"&&(this.touch0[1]=z.invert(this.touch0[0])),this.touch1&&h!=="touch"&&(this.touch1[1]=z.invert(this.touch1[0])),this.that.__zoom=z,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(h){var z=W(this.that).datum();c.call(h,this.that,new $o(h,{sourceEvent:this.sourceEvent,target:g,transform:this.that.__zoom,dispatch:c}),z)}};function T(h,...z){if(!t.apply(this,arguments))return;var x=I(this,z).event(h),A=this.__zoom,L=Math.max(o[0],Math.min(o[1],A.k*Math.pow(2,r.apply(this,arguments)))),w=ot(h);if(x.wheel)(x.mouse[0][0]!==w[0]||x.mouse[0][1]!==w[1])&&(x.mouse[1]=A.invert(x.mouse[0]=w)),clearTimeout(x.wheel);else{if(A.k===L)return;x.mouse=[w,A.invert(w)],It(this),x.start()}yt(h),x.wheel=setTimeout(M,b),x.zoom("mouse",n(j(N(A,L),x.mouse[0],x.mouse[1]),x.extent,s));function M(){x.wheel=null,x.end()}}function $(h,...z){if(p||!t.apply(this,arguments))return;var x=h.currentTarget,A=I(this,z,!0).event(h),L=W(h.view).on("mousemove.zoom",Y,!0).on("mouseup.zoom",X,!0),w=ot(h,x),M=h.clientX,S=h.clientY;Fe(h.view),Vt(h),A.mouse=[w,this.__zoom.invert(w)],It(this),A.start();function Y(P){if(yt(P),!A.moved){var G=P.clientX-M,q=P.clientY-S;A.moved=G*G+q*q>v}A.event(P).zoom("mouse",n(j(A.that.__zoom,A.mouse[0]=ot(P,x),A.mouse[1]),A.extent,s))}function X(P){L.on("mousemove.zoom mouseup.zoom",null),$e(P.view,A.moved),yt(P),A.event(P).end()}}function D(h,...z){if(t.apply(this,arguments)){var x=this.__zoom,A=ot(h.changedTouches?h.changedTouches[0]:h,this),L=x.invert(A),w=x.k*(h.shiftKey?.5:2),M=n(j(N(x,w),A,L),e.apply(this,z),s);yt(h),a>0?W(this).transition().duration(a).call(k,M,A,h):W(this).call(g.transform,M,A,h)}}function F(h,...z){if(t.apply(this,arguments)){var x=h.touches,A=x.length,L=I(this,z,h.changedTouches.length===A).event(h),w,M,S,Y;for(Vt(h),M=0;M<A;++M)S=x[M],Y=ot(S,this),Y=[Y,this.__zoom.invert(Y),S.identifier],L.touch0?!L.touch1&&L.touch0[2]!==Y[2]&&(L.touch1=Y,L.taps=0):(L.touch0=Y,w=!0,L.taps=1+!!l);l&&(l=clearTimeout(l)),w&&(L.taps<2&&(y=Y[0],l=setTimeout(function(){l=null},f)),It(this),L.start())}}function E(h,...z){if(this.__zooming){var x=I(this,z).event(h),A=h.changedTouches,L=A.length,w,M,S,Y;for(yt(h),w=0;w<L;++w)M=A[w],S=ot(M,this),x.touch0&&x.touch0[2]===M.identifier?x.touch0[0]=S:x.touch1&&x.touch1[2]===M.identifier&&(x.touch1[0]=S);if(M=x.that.__zoom,x.touch1){var X=x.touch0[0],P=x.touch0[1],G=x.touch1[0],q=x.touch1[1],H=(H=G[0]-X[0])*H+(H=G[1]-X[1])*H,B=(B=q[0]-P[0])*B+(B=q[1]-P[1])*B;M=N(M,Math.sqrt(H/B)),S=[(X[0]+G[0])/2,(X[1]+G[1])/2],Y=[(P[0]+q[0])/2,(P[1]+q[1])/2]}else if(x.touch0)S=x.touch0[0],Y=x.touch0[1];else return;x.zoom("touch",n(j(M,S,Y),x.extent,s))}}function V(h,...z){if(this.__zooming){var x=I(this,z).event(h),A=h.changedTouches,L=A.length,w,M;for(Vt(h),p&&clearTimeout(p),p=setTimeout(function(){p=null},f),w=0;w<L;++w)M=A[w],x.touch0&&x.touch0[2]===M.identifier?delete x.touch0:x.touch1&&x.touch1[2]===M.identifier&&delete x.touch1;if(x.touch1&&!x.touch0&&(x.touch0=x.touch1,delete x.touch1),x.touch0)x.touch0[1]=this.__zoom.invert(x.touch0[0]);else if(x.end(),x.taps===2&&(M=ot(M,this),Math.hypot(y[0]-M[0],y[1]-M[1])<m)){var S=W(this).on("dblclick.zoom");S&&S.apply(this,arguments)}}}return g.wheelDelta=function(h){return arguments.length?(r=typeof h=="function"?h:Mt(+h),g):r},g.filter=function(h){return arguments.length?(t=typeof h=="function"?h:Mt(!!h),g):t},g.touchable=function(h){return arguments.length?(i=typeof h=="function"?h:Mt(!!h),g):i},g.extent=function(h){return arguments.length?(e=typeof h=="function"?h:Mt([[+h[0][0],+h[0][1]],[+h[1][0],+h[1][1]]]),g):e},g.scaleExtent=function(h){return arguments.length?(o[0]=+h[0],o[1]=+h[1],g):[o[0],o[1]]},g.translateExtent=function(h){return arguments.length?(s[0][0]=+h[0][0],s[1][0]=+h[1][0],s[0][1]=+h[0][1],s[1][1]=+h[1][1],g):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},g.constrain=function(h){return arguments.length?(n=h,g):n},g.duration=function(h){return arguments.length?(a=+h,g):a},g.interpolate=function(h){return arguments.length?(u=h,g):u},g.on=function(){var h=c.on.apply(c,arguments);return h===c?g:h},g.clickDistance=function(h){return arguments.length?(v=(h=+h)*h,g):Math.sqrt(v)},g.tapDistance=function(h){return arguments.length?(m=+h,g):m},g}const Bo={backgroundColor:"#000",backgroundImage:"radial-gradient(rgba(255,255,255,0.12) 1px, transparent 1px)",backgroundSize:"20px 20px",backgroundPosition:"-10px -10px"};function Go({nodes:t,links:e,dims:n,repelForce:r,linkDistance:i}){const o=R.useMemo(()=>Io(),[]);return R.useEffect(()=>{const s=n.w/2,a=n.h/2;o.nodes(t);const c=.05+(1-Math.min(1,Math.max(0,r/800)))*.95,l=Math.max(10,500-i);return o.force("link",ko(e).id(y=>y.id).distance(l).strength(.5)).force("charge",Lo().strength(-r)).force("gravityX",Do(s).strength(c)).force("gravityY",Fo(a).strength(c)).force("collide",No().radius(y=>15+y.val).strength(.8)),o.alpha(1).restart(),()=>o.stop()},[o,t,e,n]),R.useEffect(()=>{const s=n.w/2,a=n.h/2,u=Math.max(10,500-i),l=.05+(1-Math.min(1,Math.max(0,r/800)))*.95;o.force("charge")?.strength(-r),o.force("gravityX")?.x(s).strength(l),o.force("gravityY")?.y(a).strength(l),o.force("link")?.distance(u),o.alpha(.5).alphaTarget(0).restart()},[o,r,i,n]),o}const et={nodeFill:"#e4e4e7",nodeActive:"#ffffff",link:"#27272a",text:"#ffffff"};function qo({nodes:t,links:e,dims:n,activeCluster:r,onOpenNote:i,nodeSize:o,linkThickness:s,fontSize:a,repelForce:u,linkDistance:c,query:l="",setHoveredNode:y,wrapperRef:p,svgRef:f,zoomRef:b,nodesRef:v,searchRef:m}){const g=R.useRef(null),N=R.useRef(!1),j=R.useRef(i);R.useEffect(()=>{j.current=i},[i]);const d=R.useRef(y);R.useEffect(()=>{d.current=y},[y]);const k=Go({nodes:t,links:e,dims:n,repelForce:u,linkDistance:c});R.useEffect(()=>{if(!f.current||!k)return;const C=n.w,T=n.h,$=W(f.current);if(!g.current){const w=$.append("g");g.current=w,w.append("g").attr("class","links"),w.append("g").attr("class","nodes"),w.append("g").attr("class","labels"),$.append("text").attr("class","empty-state").attr("x",C/2).attr("y",T/2).attr("text-anchor","middle").attr("fill","#666").attr("font-family","monospace").style("pointer-events","none")}const D=g.current;if(!t||t.length===0){$.select(".empty-state").text("No nodes (0)").style("opacity",1),D.style("opacity",0);return}else $.select(".empty-state").style("opacity",0),D.style("opacity",1);const F=D.select(".links"),E=D.select(".nodes"),V=D.select(".labels");v.current=t;const h=F.selectAll("path").data(e,w=>w.id).join("path").attr("fill","none").attr("stroke",et.link).attr("stroke-opacity",.6).attr("stroke-width",s).attr("class","link-element"),z=E.selectAll("circle").data(t,w=>w.id).join("circle").attr("r",w=>(w.type==="project"?10:6+Math.sqrt(w.val*3))*o).attr("fill",w=>w.type==="project"?w.color:et.nodeFill).attr("stroke","none").attr("stroke-width",0).style("cursor","pointer").attr("class","node-element").call(I(k)),x=V.selectAll("text").data(t,w=>w.id).join("text").text(w=>w.title).attr("font-size",w=>(10+w.val)*a).attr("fill",et.text).attr("text-anchor","middle").attr("dy",w=>28+w.val).attr("opacity",.7).style("pointer-events","none").style("transition","opacity 0.2s").attr("class","label-element").style("font-family","var(--font-mono)");z.on("click",(w,M)=>{const S=j.current;M.type==="project"?S&&S(M.realId,"project"):S&&S(M.id)}).on("mouseover",(w,M)=>{d.current?.(M),h.attr("stroke",S=>S.source.id===M.id||S.target.id===M.id?"#fff":et.link).attr("stroke-opacity",S=>S.source.id===M.id||S.target.id===M.id?1:.1),z.attr("opacity",S=>{const Y=e.some(X=>X.source.id===M.id&&X.target.id===S.id||X.target.id===M.id&&X.source.id===S.id);return S.id===M.id||Y?1:.1}).attr("fill",S=>S.id===M.id?et.nodeActive:S.type==="project"?S.color:et.nodeFill),x.attr("opacity",S=>S.id===M.id?1:0)}).on("mouseout",()=>{d.current?.(null),A()});const A=()=>{const w=m.current?m.current.toLowerCase().trim():"";w.length>0?(z.attr("opacity",S=>(S.title||"").toLowerCase().includes(w)||(S.tags||[]).some(X=>X.toLowerCase().includes(w))?1:.1),z.attr("fill",S=>S.type==="project"?S.color:et.nodeFill),h.attr("stroke",et.link).attr("stroke-opacity",.1),x.attr("opacity",S=>(S.title||"").toLowerCase().includes(w)||(S.tags||[]).some(X=>X.toLowerCase().includes(w))?1:0)):(h.attr("stroke",et.link).attr("stroke-opacity",.6).attr("opacity",1),z.attr("opacity",1).attr("fill",S=>S.type==="project"?S.color:et.nodeFill),x.attr("opacity",.7))};A(),k.on("tick",()=>{h.attr("d",w=>`M${w.source.x},${w.source.y}L${w.target.x},${w.target.y}`),z.attr("cx",w=>w.x).attr("cy",w=>w.y),x.attr("x",w=>w.x).attr("y",w=>w.y)});const L=Vo().scaleExtent([.1,4]).on("zoom",w=>{D.attr("transform",w.transform);const M=w.transform.k;x.attr("opacity",S=>{if(m.current){const Y=m.current.toLowerCase();return(S.title||"").toLowerCase().includes(Y)||(S.tags||[]).some(P=>P.toLowerCase().includes(Y))?1:0}return M>.8?1:M<.25?0:S.val>2?1:.7})});return b.current=L,$.call(L),N.current||(setTimeout(()=>{$.transition().duration(750).call(L.transform,Yt.translate(C/2,T/2).scale(.8).translate(-C/2,-T/2))},500),N.current=!0),()=>{k.on("tick",null)}},[k,t,e,n,v,m,f,b]),R.useEffect(()=>{if(!f.current)return;const C=W(f.current);C.selectAll(".node-element").transition().duration(300).attr("r",T=>(T.type==="project"?10:6+Math.sqrt(T.val*3))*o),C.selectAll(".link-element").transition().duration(300).attr("stroke-width",s),C.selectAll(".label-element").transition().duration(300).attr("font-size",T=>(10+T.val)*a)},[o,s,a,f]),R.useEffect(()=>{if(!f.current)return;const C=W(f.current),T=C.selectAll(".node-element"),$=C.selectAll(".label-element"),D=C.selectAll(".link-element"),F=(l||"").toLowerCase().trim();F?(T.style("opacity",E=>(E.title||"").toLowerCase().includes(F)||(E.tags||[]).some(h=>h.toLowerCase().includes(F))?1:.1),D.style("opacity",.1),$.style("opacity",E=>(E.title||"").toLowerCase().includes(F)||(E.tags||[]).some(h=>h.toLowerCase().includes(F))?1:0)):(T.style("opacity",1).style("fill",E=>E.type==="project"?E.color:et.nodeFill),D.style("opacity",1).attr("stroke-opacity",.6),$.style("opacity",E=>r!=null?E.group===r?1:0:E.val>2?1:.5))},[l,r,t,f]);function I(C){function T(F){F.active||C.alphaTarget(.3).restart(),F.subject.fx=F.subject.x,F.subject.fy=F.subject.y}function $(F){F.subject.fx=F.x,F.subject.fy=F.y}function D(F){F.active||C.alphaTarget(0),F.subject.fx=null,F.subject.fy=null}return qr().on("start",T).on("drag",$).on("end",D)}return _.jsxs("div",{className:"relative w-full h-full bg-black overflow-hidden touch-none",ref:p,children:[_.jsx("div",{className:"absolute inset-0 opacity-20 pointer-events-none",style:Bo}),_.jsx("svg",{ref:f,className:"w-full h-full block"})]})}const Ho=qe.memo(qo),we=["#2dd4bf","#f472b6","#fbbf24","#818cf8","#34d399","#a78bfa"];function Uo({isPanelOpen:t,setIsPanelOpen:e,searchQuery:n,setSearchQuery:r,searchResults:i,handleZoomToNode:o,showOnlyProjects:s,setShowOnlyProjects:a,showOrphans:u,setShowOrphans:c,showGhostNodes:l,setShowGhostNodes:y,showSignals:p,setShowSignals:f,nodeSize:b,setNodeSize:v,linkThickness:m,setLinkThickness:g,fontSize:N,setFontSize:j,repelForce:d,setRepelForce:k,linkDistance:I,setLinkDistance:C,hotTags:T,activeCluster:$,setActiveCluster:D,clusters:F}){return _.jsxs(_.Fragment,{children:[_.jsx("button",{onClick:()=>e(!t),className:`absolute top-6 right-6 z-50 w-10 h-10 flex items-center justify-center rounded-lg border transition-all duration-300 ${t?"bg-white text-black border-white":"bg-black/50 text-zinc-400 border-white/10 hover:text-white hover:border-white/20 backdrop-blur-md"}`,"aria-label":"Toggle Graph Controls",children:_.jsx(ae,{name:t?"x":"settings",size:20})}),t&&_.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>e(!1)}),_.jsxs("div",{className:`absolute top-20 right-6 bottom-6 w-80 z-40 bg-black/90 backdrop-blur-xl border border-white/10 rounded-2xl transition-all duration-300 ease-[cubic-bezier(0.23,1,0.32,1)] will-change-transform flex flex-col font-mono shadow-2xl ${t?"translate-x-0 opacity-100":"translate-x-10 opacity-0 pointer-events-none"}`,children:[_.jsx("div",{className:"flex-none p-5 border-b border-white/5 flex items-center justify-between",children:_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("span",{className:"text-fluid-2xs uppercase tracking-widest text-zinc-500 font-bold",children:"ConneXa"}),_.jsx("span",{className:"text-fluid-3xs bg-white/5 px-1.5 py-0.5 rounded text-zinc-600",children:"Controls"})]})}),_.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 space-y-8",children:[_.jsxs("div",{className:"space-y-3",children:[_.jsx("div",{className:"text-fluid-3xs text-zinc-600 uppercase tracking-widest font-bold",children:"Search"}),_.jsxs("div",{className:"relative",children:[_.jsx(ae,{name:"search",size:14,className:"absolute left-3 top-2.5 text-zinc-500"}),_.jsx(He,{placeholder:"Find node...",value:n,onChange:E=>r(E.target.value),className:"pl-9 py-2 text-xs w-full bg-white/5 border-white/10 focus:bg-white/10 focus:border-white/20 rounded-lg text-zinc-300 placeholder:text-zinc-600"})]}),i.length>0&&_.jsx("div",{className:"flex flex-col gap-1 max-h-40 overflow-y-auto custom-scrollbar pt-2",children:i.map(E=>_.jsxs("button",{onClick:()=>o(E.id),className:"flex items-center gap-3 p-2 rounded-lg hover:bg-white/5 text-left group transition-colors",children:[_.jsx("div",{className:"w-2 h-2 rounded-full ring-1 ring-white/20 group-hover:ring-white/50 transition-all",style:{background:E.color}}),_.jsx("span",{className:"text-xs text-zinc-400 group-hover:text-zinc-200 truncate font-mono",children:E.title})]},E.id))})]}),_.jsxs("div",{className:"space-y-3",children:[_.jsx("div",{className:"text-fluid-3xs text-zinc-600 uppercase tracking-widest font-bold",children:"Filters"}),_.jsxs("div",{className:"space-y-1",children:[_.jsxs("label",{className:"flex items-center justify-between py-2 text-xs text-zinc-400 cursor-pointer group hover:bg-white/5 px-2 -mx-2 rounded-lg transition-colors",children:[_.jsx("span",{className:"group-hover:text-zinc-200 transition-colors",children:"Show Only Projects"}),_.jsx("input",{type:"checkbox",checked:s,onChange:E=>a(E.target.checked),className:"accent-white"})]}),_.jsxs("label",{className:"flex items-center justify-between py-2 text-xs text-zinc-400 cursor-pointer group hover:bg-white/5 px-2 -mx-2 rounded-lg transition-colors",children:[_.jsx("span",{className:"group-hover:text-zinc-200 transition-colors",children:"Show Orphans"}),_.jsx("input",{type:"checkbox",checked:u,onChange:E=>c(E.target.checked),className:"accent-white"})]}),_.jsxs("label",{className:"flex items-center justify-between py-2 text-xs text-zinc-400 cursor-pointer group hover:bg-white/5 px-2 -mx-2 rounded-lg transition-colors",children:[_.jsx("span",{className:"group-hover:text-zinc-200 transition-colors",children:"Ghost Nodes"}),_.jsx("input",{type:"checkbox",checked:l,onChange:E=>y(E.target.checked),className:"accent-white"})]})]})]}),_.jsxs("div",{className:"space-y-4",children:[_.jsx("div",{className:"text-fluid-3xs text-zinc-600 uppercase tracking-widest font-bold",children:"Display"}),_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{className:"space-y-2",children:[_.jsxs("div",{className:"flex justify-between text-fluid-3xs text-zinc-500 font-mono",children:[_.jsx("span",{children:"Node Size"}),_.jsxs("span",{children:[b,"x"]})]}),_.jsx("input",{type:"range",min:"0.5",max:"2",step:"0.1",value:b,onChange:E=>v(parseFloat(E.target.value)),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-white hover:accent-zinc-300"})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsxs("div",{className:"flex justify-between text-fluid-3xs text-zinc-500 font-mono",children:[_.jsx("span",{children:"Link Thickness"}),_.jsxs("span",{children:[m,"px"]})]}),_.jsx("input",{type:"range",min:"0.5",max:"5",step:"0.5",value:m,onChange:E=>g(parseFloat(E.target.value)),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-white hover:accent-zinc-300"})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsxs("div",{className:"flex justify-between text-fluid-3xs text-zinc-500 font-mono",children:[_.jsx("span",{children:"Text Size"}),_.jsxs("span",{children:[N,"x"]})]}),_.jsx("input",{type:"range",min:"0.5",max:"2",step:"0.1",value:N,onChange:E=>j(parseFloat(E.target.value)),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-white hover:accent-zinc-300"})]})]})]}),_.jsxs("div",{className:"space-y-4",children:[_.jsx("div",{className:"text-fluid-3xs text-zinc-600 uppercase tracking-widest font-bold",children:"Physics"}),_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{className:"space-y-2",children:[_.jsxs("div",{className:"flex justify-between text-fluid-3xs text-zinc-500 font-mono",children:[_.jsx("span",{children:"Entropy"}),_.jsx("span",{children:d})]}),_.jsx("input",{type:"range",min:"10",max:"800",step:"10",value:d,onChange:E=>k(parseInt(E.target.value)),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-white hover:accent-zinc-300"})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsxs("div",{className:"flex justify-between text-fluid-3xs text-zinc-500 font-mono",children:[_.jsx("span",{children:"Entanglement"}),_.jsx("span",{children:I})]}),_.jsx("input",{type:"range",min:"10",max:"500",step:"10",value:I,onChange:E=>C(parseInt(E.target.value)),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-white hover:accent-zinc-300"})]})]})]}),_.jsxs("div",{className:"space-y-3",children:[_.jsx("div",{className:"text-fluid-3xs text-zinc-600 uppercase tracking-widest font-bold",children:"Momentum"}),_.jsxs("div",{className:"flex flex-wrap gap-2",children:[Array.from(T).slice(0,10).map(E=>_.jsxs("span",{className:"text-fluid-3xs bg-white/5 border border-white/10 text-zinc-400 px-2.5 py-1 rounded-full hover:bg-white/10 hover:text-white transition-colors cursor-default font-mono",children:["#",E]},E)),T.size===0&&_.jsx("span",{className:"text-xs text-zinc-700 italic font-mono",children:"No trending tags"})]})]}),_.jsxs("div",{className:"space-y-3 pb-8",children:[_.jsx("div",{className:"text-fluid-3xs text-zinc-600 uppercase tracking-widest font-bold",children:"Clusters"}),_.jsx("div",{className:"space-y-1",children:F.slice(0,5).map((E,V)=>_.jsxs("button",{onClick:()=>D($===V?null:V),className:`w-full text-left text-xs px-2 py-2 rounded-lg flex items-center justify-between transition-all ${$===V?"bg-white/10 text-white":"text-zinc-500 hover:bg-white/5 hover:text-zinc-300"}`,children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"w-2 h-2 rounded-full",style:{background:we[V%we.length]}}),_.jsx("span",{className:"truncate max-w-[120px] font-mono",children:E.name})]}),_.jsx("span",{className:"text-zinc-600 font-mono text-fluid-3xs",children:E.size})]},V))})]})]})]})]})}const _e=["#2dd4bf","#f472b6","#fbbf24","#818cf8","#34d399","#a78bfa"],Ko={nodeStroke:"none"};function Wo({notes:t,projects:e=[],onOpenNote:n}){const r=R.useRef(null),i=R.useRef(null),o=R.useRef(null),[s,a]=R.useState({w:800,h:600}),[u,c]=R.useState(null),[l,y]=R.useState(null),[p,f]=R.useState(!1),[b,v]=R.useState(""),[m,g]=R.useState(!1),[N,j]=R.useState(!0),[d,k]=R.useState(!1),[I,C]=R.useState(()=>parseFloat(localStorage.getItem("maia_graph_nodeSize"))||1),[T,$]=R.useState(()=>parseFloat(localStorage.getItem("maia_graph_linkThickness"))||1.5),[D,F]=R.useState(()=>parseFloat(localStorage.getItem("maia_graph_fontSize"))||1),[E,V]=R.useState(()=>parseInt(localStorage.getItem("maia_graph_repelForce"))||150),[h,z]=R.useState(()=>parseInt(localStorage.getItem("maia_graph_linkDistance"))||100);R.useEffect(()=>localStorage.setItem("maia_graph_nodeSize",I),[I]),R.useEffect(()=>localStorage.setItem("maia_graph_linkThickness",T),[T]),R.useEffect(()=>localStorage.setItem("maia_graph_fontSize",D),[D]),R.useEffect(()=>localStorage.setItem("maia_graph_repelForce",E),[E]),R.useEffect(()=>localStorage.setItem("maia_graph_linkDistance",h),[h]);const x=R.useRef(""),A=R.useRef([]);R.useEffect(()=>{x.current=b},[b]);const L=R.useMemo(()=>{const X=Ue(t),P=new Map;X.forEach((B,tt)=>{B.notes.forEach(O=>P.set(O.id,tt))});const G=Ke(t),q=new Set(G.filter(B=>B.velocity>0).map(B=>B.tag));return{rawClusters:X,clusterMap:P,isHot:B=>(B.tags||[]).some(tt=>q.has(tt)),hotTags:q}},[t]),{nodes:w,links:M}=R.useMemo(()=>{const X=O=>(O||"").trim().toLowerCase();let P=t.map(O=>{const U=L.clusterMap.get(O.id),ft=U!==void 0?_e[U%_e.length]:Ko.nodeStroke;return{id:O.id,title:O.title||"Untitled",type:"note",group:U,color:ft,isHot:L.isHot(O),tags:O.tags||[],val:1,projectIds:O.projectIds||[]}});const G=e.map(O=>({id:`proj-${O.id}`,realId:O.id,title:O.name,type:"project",color:"#3b82f6",val:3,tags:["Project"]}));m&&(P=[]);let q=[...P,...G];const H=new Map(t.map(O=>[X(O.title),O.id])),B=[],tt=new Map;if(t.forEach(O=>{if(m)return;const U=O.id;let ft=!1;((O.content||"").match(/\[\[(.+?)\]\]/g)||[]).forEach(zt=>{const kt=zt.slice(2,-2).trim(),gt=X(kt),St=H.get(gt);if(St&&St!==U)B.push({source:U,target:St}),ft=!0;else if(!St&&d&&kt){if(!tt.has(gt)){const ie={id:`ghost-${gt}`,title:kt,type:"ghost",color:"#3f3f46",val:1,tags:["Missing"]};tt.set(gt,ie),q.push(ie)}B.push({source:U,target:tt.get(gt).id}),ft=!0}}),e.forEach(zt=>{O.projectIds&&O.projectIds.includes(zt.id)&&(B.push({source:U,target:`proj-${zt.id}`}),ft=!0)}),!ft&&!N&&(O._orphan=!0)}),!N){const O=new Set;B.forEach(U=>{O.add(U.source),O.add(U.target)}),q=q.filter(U=>U.type==="project"||U.type==="ghost"||O.has(U.id))}return{nodes:q,links:B}},[t,e,L,m,d,N]),S=X=>{const P=A.current.find(B=>B.id===X);if(!P||!r.current||!o.current)return;const G=s.w,q=s.h;W(r.current).transition().duration(1e3).call(o.current.transform,Yt.translate(G/2,q/2).scale(1.5).translate(-P.x,-P.y)),c(P)},Y=R.useMemo(()=>{if(!b)return[];const X=b.toLowerCase();return w.filter(P=>(P.title||"").toLowerCase().includes(X)||(P.tags||[]).some(G=>G.toLowerCase().includes(X))).slice(0,5)},[b,w]);return R.useEffect(()=>{if(!i.current)return;const X=new ResizeObserver(P=>{const{width:G,height:q}=P[0].contentRect;a({w:G,h:q})});return X.observe(i.current),()=>X.disconnect()},[]),_.jsxs("div",{className:"relative w-full h-full bg-black overflow-hidden",children:[_.jsx(Ho,{nodes:w,links:M,dims:s,activeCluster:l,onOpenNote:n,nodeSize:I,linkThickness:T,fontSize:D,repelForce:E,linkDistance:h,query:b,setHoveredNode:c,wrapperRef:i,svgRef:r,zoomRef:o,nodesRef:A,searchRef:x}),_.jsx(Uo,{isPanelOpen:p,setIsPanelOpen:f,searchQuery:b,setSearchQuery:v,searchResults:Y,handleZoomToNode:S,showOnlyProjects:m,setShowOnlyProjects:g,showOrphans:N,setShowOrphans:j,showGhostNodes:d,setShowGhostNodes:k,nodeSize:I,setNodeSize:C,linkThickness:T,setLinkThickness:$,fontSize:D,setFontSize:F,repelForce:E,setRepelForce:V,linkDistance:h,setLinkDistance:z,hotTags:L.hotTags,activeCluster:l,setActiveCluster:y,clusters:L.rawClusters}),u&&_.jsxs("div",{className:"absolute pointer-events-none z-20 min-w-[200px] max-w-[260px] bg-black/90 backdrop-blur-xl border border-white/10 rounded-2xl p-5 shadow-2xl font-mono",style:{top:80,right:24},children:[_.jsx("div",{className:"text-white font-medium text-xs leading-tight",children:u.title}),_.jsx("div",{className:"text-fluid-3xs text-zinc-500 mt-2 flex flex-wrap gap-1",children:u.tags.length>0?u.tags.map(X=>_.jsxs("span",{className:"bg-white/5 border border-white/10 px-1.5 py-0.5 rounded-full",children:["#",X]},X)):_.jsx("span",{className:"italic opacity-50",children:"No tags"})}),_.jsx("div",{className:"mt-3 pt-2 border-t border-white/5 text-fluid-3xs text-zinc-600 uppercase tracking-widest font-bold",children:"Click to open"})]})]})}export{Wo as default};
